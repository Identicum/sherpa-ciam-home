{% extends "index.html" %}

{% block title %} Deployment Report - {{ artifact }} - {{ timestamp }}{% endblock %}

{% block content %}
<div class="container">
    <h1>Deployment Report - {{ artifact }} ({{ environment }})</h1>
    {% set day = timestamp[6:8] %}
    {% set month = timestamp[4:6] %}
    {% set year = timestamp[2:4] %}
    {% set hour = timestamp[9:11]|int %}
    {% set minute = timestamp[11:13]|int %}
    {% if minute >= 60 %}
        {% set hour = hour + ((minute / 60)|int) %}
        {% set minute = minute % 60 %}
    {% endif %}
    {% if hour >= 24 %}
        {% set hour = hour % 24 %}
    {% endif %}
    {% set hour_str = ("0" + hour|string) if hour < 10 else hour|string %}
    {% set minute_str = ("0" + minute|string) if minute < 10 else minute|string %}
    <p><strong>Timestamp:</strong> {{ day }}/{{ month }}/{{ year }} {{ hour_str }}:{{ minute_str }}</p>
    
    <h3>Deployment Logs</h3>
    <div class="card mb-3">
        <div class="card-body {% if status == 'failed' %}bg-danger bg-opacity-10{% else %}bg-light{% endif %}">
            <pre class="mb-0 {% if status == 'failed' %}text-danger{% endif %}" style="white-space: pre-wrap; word-wrap: break-word; font-size: 0.875rem; max-height: 500px; overflow-y: auto;">{{ logs }}</pre>
        </div>
    </div>
    
    {% if from_artifact == 'all' %}
        <a href="{{ url_for('deployments.deployments', environment=environment) }}" class="btn btn-secondary">Back to Reports</a>
    {% else %}
        <a href="{{ url_for('deployments.deployments', environment=environment, artifact=from_artifact) }}" class="btn btn-secondary">Back to Reports</a>
    {% endif %}
</div>
{% endblock %}
